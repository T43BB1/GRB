
PLAY [intranetweb] *************************************************************

TASK [Gathering Facts] *********************************************************
ok: [10.0.2.11]

TASK [set_fact] ****************************************************************
ok: [10.0.2.11]

TASK [debug] *******************************************************************
ok: [10.0.2.11] => {
    "diag": "Audit docker.socket"
}

TASK [debug] *******************************************************************
ok: [10.0.2.11] => {
    "num": 7
}

TASK [shell] *******************************************************************
fatal: [10.0.2.11]: FAILED! => {"changed": true, "cmd": "auditctl -l | grep /lib/systemd/system/docker.socket", "delta": "0:00:00.018477", "end": "2024-10-28 12:37:01.662994", "msg": "non-zero return code", "rc": 1, "start": "2024-10-28 12:37:01.644517", "stderr": "You must be root to run this program.", "stderr_lines": ["You must be root to run this program."], "stdout": "", "stdout_lines": []}
...ignoring

TASK [debug] *******************************************************************
ok: [10.0.2.11] => {
    "ret": {
        "changed": true,
        "cmd": "auditctl -l | grep /lib/systemd/system/docker.socket",
        "delta": "0:00:00.018477",
        "end": "2024-10-28 12:37:01.662994",
        "failed": true,
        "msg": "non-zero return code",
        "rc": 1,
        "start": "2024-10-28 12:37:01.644517",
        "stderr": "You must be root to run this program.",
        "stderr_lines": [
            "You must be root to run this program."
        ],
        "stdout": "",
        "stdout_lines": []
    }
}

TASK [set_fact] ****************************************************************
ok: [10.0.2.11]

TASK [debug] *******************************************************************
ok: [10.0.2.11] => {
    "weak": "ret.stdout == ''"
}

TASK [set_fact] ****************************************************************
ok: [10.0.2.11]

TASK [set_fact] ****************************************************************
skipping: [10.0.2.11]

TASK [debug] *******************************************************************
ok: [10.0.2.11] => {
    "reason": [
        "/lib/systemd/system/docker.socket file does not have audit settings applied."
    ]
}

TASK [set_fact] ****************************************************************
ok: [10.0.2.11]

TASK [debug] *******************************************************************
ok: [10.0.2.11] => {
    "bypass": null
}

TASK [debug] *******************************************************************
ok: [10.0.2.11] => {
    "msg": "취약"
}

TASK [copy] ********************************************************************
ok: [10.0.2.11 -> localhost]

TASK [debug] *******************************************************************
skipping: [10.0.2.11]

TASK [copy] ********************************************************************
skipping: [10.0.2.11]

PLAY RECAP *********************************************************************
10.0.2.11                  : ok=14   changed=1    unreachable=0    failed=0    skipped=3    rescued=0    ignored=1   

